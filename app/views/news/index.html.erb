<div class="Page">
  <div class="Page__Header">
    <h1 class="Page__Title">The Daily Chronicle</h1>
    <p class="Page__Subtitle">Market reports, world events, and trading history</p>
  </div>

  <div class="Page__Content">
    <!-- Tabbed Filters -->
    <div class="tabs">
      <div class="tabs__list">
        <%= link_to "All News", news_path(days_back: @days_back),
            class: "tabs__tab #{@current_filter.nil? ? 'tabs__tab--active' : ''}" %>
        <%= link_to "World Events", news_path(type: 'event', days_back: @days_back),
            class: "tabs__tab #{@current_filter == 'event' ? 'tabs__tab--active' : ''}" %>
        <%= link_to "Market Reports", news_path(type: 'market', days_back: @days_back),
            class: "tabs__tab #{@current_filter == 'market' ? 'tabs__tab--active' : ''}" %>
        <%= link_to "My Trades", news_path(type: 'action', days_back: @days_back),
            class: "tabs__tab #{@current_filter == 'action' ? 'tabs__tab--active' : ''}" %>
        <%= link_to "Trends", news_path(type: 'trend', days_back: @days_back),
            class: "tabs__tab #{@current_filter == 'trend' ? 'tabs__tab--active' : ''}" %>
      </div>
      <div class="tabs__content">
        <!-- News Feed -->
        <div class="newsfeed">
      <% if @news_feed.any? %>
        <% @news_feed.group_by(&:game_day).sort.reverse.each do |day, items| %>
          <section class="newsfeed__day">
            <h2 class="newsfeed__day-header">
              <% if day.nil? %>
                Day <%= current_game.current_day %>
              <% elsif day == 0 %>
                Arrival Day
              <% elsif day < 0 %>
                <%= day.abs %> <%= 'day'.pluralize(day.abs) %> before arrival
              <% else %>
                Day <%= day %>
              <% end %>
            </h2>

            <% items.each do |news_item| %>
              <%= render partial: "news/news_item", locals: { item: news_item } %>
            <% end %>
          </section>
        <% end %>
      <% else %>
        <div class="Alert Alert--info">
          <p>No news to report for the selected filters.</p>
        </div>
      <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
